---
tags:
  - mobile
screen: Exercise Picker
agent: "[[designer]]"
feature: "[[features/2-workout_process]]"
design_state: "[[Statuses/Finished]]"
---
# 2.01 - Exercise Picker Screen

> **Parent Feature**: [2-workout_process.md](../features/2-workout_process.md)
> **Navigation**: See [00-app-overview.md](../features/00-app-overview.md) for complete flows

## 1. Visual Preview
> [!TIP]
> *[Insert Screen Mockup Here]*
> *For now, we can use a placeholder or a Mermaid diagram if applicable.*

## 2. Human-Readable Summary
**User Behavior**
The user arrives here to add exercises to their workout. They can search for specific exercises by name or filter by body part categories (e.g., Chest, Back). If they can't find an exercise, they can create a custom one instantly.

**Key Cases**
*   **Searching**: Typing in the search bar filters the list.
*   **Filtering**: Tapping category pills (e.g., "Legs") filters the list.
*   **Adding**: Tapping an exercise card adds it to the workout (showing a checkmark).
*   **Creating Custom**: If no results are found, a "Create '[Query]'" button appears to quickly add a new exercise.

**Data Displayed**
*   **Exercise List**: List of available exercises with names and categories.
*   **Filters**: Search bar and category pills.
*   **Feedback**: Toasts confirm when an exercise is added.

## 3. Detailed Designer Specification
### <exercise_picker_screen>

#### Context Modes (NEW - Plan Customization Support)

**Purpose:** Exercise Picker supports multiple entry contexts with different behaviors.

**Modes:**

1. **NORMAL** (Default - Active Workout)
   - Entry: From Active Workout screen
   - Behavior: Add exercises to current workout session
   - Header: "Select Exercise"
   - Tap exercise: Adds to workout, shows checkmark, toast confirmation
   - Back button: Returns to Active Workout

2. **ADDING_MODE** (Plan Builder Days — "Stay in Picker" Pattern)
   - Entry: Plan Builder Days (5.03) → Expanded Day → "+ Add Exercise"
   - Behavior: Add **multiple exercises** in one trip (see `<adding_mode_spec>` below)
   - Header: "Add to [Day Name]" (e.g., "Add to Push")
   - Context Banner: "Adding to [Day Name] · [X] added"
   - Tap exercise: Opens Target Config (5.04) with "Save & Add Another" → Returns HERE
   - Bottom Button: "Done (X)" — returns to Plan Builder Days
   - Back arrow: Same as "Done (X)" — returns to Plan Builder Days

3. **REPLACE** (Plan Builder Days)
   - Entry: Plan Builder Days (5.03) → Exercise Row Menu → "Replace"
   - Behavior: Replace existing exercise in plan
   - Header: "Replace [Exercise Name]" (e.g., "Replace Bench Press")
   - Tap exercise: Opens Target Config (5.04) → Returns to Plan Builder Days
   - Back button: Returns to Plan Builder Days (no replacement)

**Mode Detection:**
- **NORMAL**: Opened from Active Workout screen
- **ADDING_MODE**: Opened from Plan Builder Days via "+ Add Exercise"
- **REPLACE**: Opened from Plan Builder Days via exercise menu → "Replace"

**Context Data Needed:**
- Day ID and Day Name (for ADDING_MODE header and saving)
- Exercise to replace (for REPLACE mode)
- List of already-added exercise IDs (for showing checkmarks in ADDING_MODE)

---

#### Top Bar
**Configuration**: Back + Title + Network Badge (follows ShapyfyTopBar component spec)

**Specifications:**
- **Height:** 56dp
- **Background:** #FFFFFF (from LightSurface)
- **Shadow:** Elevation 2dp
- **Padding:** 16dp horizontal

**Back Arrow (Left):**
- Icon: `arrow_back` (Material Icon)
- Color: #000000 (from TextOnLight)
- Size: 24dp
- Position: 16dp from left edge
- Tap area: 48dp × 48dp
- **Behavior (Context-Aware):**
  - NORMAL mode: Navigate to Active Workout hub
  - ADDING_MODE: Same as "Done (X)" — returns to Plan Builder Days (5.03)
  - REPLACE mode: Navigate to Plan Builder Days (5.03) — no replacement made

**Title (Center - Context-Aware):**
- **NORMAL mode:**
  - Text: "Select Exercise"
- **ADDING_MODE:**
  - Text: "Add to [Day Name]"
  - Example: "Add to Push", "Add to Leg Day"
  - Font: 18sp / Bold (may reduce to 16sp if text too long)
- **REPLACE mode:**
  - Text: "Replace [Exercise Name]"
  - Example: "Replace Bench Press"
  - Font: 18sp / Bold (may reduce to 16sp if text too long)
  - Truncation: Ellipsis if > 25 characters
- **Font:** 18sp / Bold
- **Color:** #000000 (from TextOnLight)
- **Alignment:** Center

**Network Badge (Right):**
- Follows standard Top Bar component specification
- Position: 16dp from right edge
- Always visible (Offline / Online / Syncing)

#### Search Bar (REDESIGNED - Premium & Accessible)

**Position:** Below top bar, 16dp margin all sides

---

### <search_bar_light_mode>

**Container:**
- **Background:** #FFFFFF (pure white - stands out from page background)
- **Border:** 2dp solid #A8E6CF (Brand Mint - prominent, on-brand)
- **Border radius:** 12dp
- **Padding:** Horizontal 16dp, Vertical 14dp
- **Height:** 56dp (increased from 48dp - more important, easier to tap)
- **Shadow:** Elevation 3dp (#000000 at 8% opacity, blur 6dp)

**Search Icon (Left):**
- Icon: `search` (Material Symbol Rounded, weight 500)
- Color: #2D7A5F (Functional Primary - brand color, not gray)
- Size: 24dp (increased from 20dp - more visible)
- Position: 16dp from left edge

**Input Field:**
- **Placeholder:** "What are we crushing today?" (personality + gym context)
- **Placeholder color:** #666666 (WCAG AA compliant - 5.74:1 contrast on white)
- **Text color:** #1A1A1A (Text Primary)
- **Font:** 16sp / Medium (slightly bolder for readability)
- **Padding left:** 12dp (from icon, increased spacing)

**Clear Button (Right - appears when text entered):**
- Icon: `close` (Material Symbol Rounded, weight 500)
- Color: #666666 (Text Secondary)
- Size: 20dp
- Touch target: 48dp × 48dp
- **Animation:** Fade in (opacity 0 → 1, 150ms) when text entered
- **Behavior:** Clears search text, shows all exercises
- **Haptic:** Light impact on tap

**Focus State (When User Taps Input):**
- **Border:** 3dp solid #2D7A5F (Functional Primary - thicker, darker green)
- **Background:** #F9FFF8 (very subtle lime tint - 98% white, 2% mint)
- **Animation:** Border width 2dp → 3dp, duration 200ms, FastOutSlowInEasing
- **Shadow:** Elevation 4dp (lifts slightly)

**Default State (Not Focused):**
- Border: 2dp solid #A8E6CF
- Background: #FFFFFF
- Shadow: Elevation 3dp

---

### </search_bar_light_mode>

---

### <search_bar_dark_mode>

**Container:**
- **Background:** #3A3F52 (elevated surface, not pure black)
- **Border:** 2dp solid #A8E6CF (Brand Mint - glows on dark)
- **Border radius:** 12dp
- **Padding:** Horizontal 16dp, Vertical 14dp
- **Height:** 56dp
- **Shadow:** Elevation 3dp (#000000 at 30% opacity, blur 8dp)
- **Glow:** 0dp 0dp 12dp rgba(168, 230, 207, 0.15) (subtle mint halo)

**Search Icon (Left):**
- Icon: `search` (Material Symbol Rounded, weight 500)
- Color: #A8E6CF (Brand Mint - bright on dark)
- Size: 24dp
- Position: 16dp from left edge

**Input Field:**
- **Placeholder:** "What are we crushing today?"
- **Placeholder color:** #B8BCC8 (accessible on dark, 7.2:1 contrast)
- **Text color:** #FFFFFF (Text Primary on dark)
- **Font:** 16sp / Medium

**Clear Button (Right):**
- Icon: `close` (Material Symbol Rounded, weight 500)
- Color: #B8BCC8 (dimmer than input text)
- Size: 20dp
- Touch target: 48dp × 48dp
- Animation: Fade in when text entered
- Haptic: Light impact on tap

**Focus State:**
- **Border:** 3dp solid #A8E6CF (bright mint)
- **Background:** #424756 (slightly lighter than default)
- **Glow:** 0dp 0dp 16dp rgba(168, 230, 207, 0.25) (intensified halo)
- **Animation:** Border width 2dp → 3dp, glow opacity 15% → 25%, duration 200ms

**Default State:**
- Border: 2dp solid #A8E6CF
- Background: #3A3F52
- Glow: 15% opacity

---

### </search_bar_dark_mode>

#### Category Pills
**Position:** Below search bar, margin bottom 16dp

**Layout:**
- **Horizontal scrollable list** (LazyRow)
- **Padding:** Horizontal 16dp
- **Spacing between pills:** 8dp

**Single Pill (Default State):**
- **Background:** #FFFFFF (from LightSurface)
- **Border:** 1dp solid #F0F0F5 (from LightGray)
- **Text color:** #2D2D2D (from TextOnLightSecondary)
- **Font:** 14sp / Medium
- **Padding:** Horizontal 16dp, Vertical 8dp
- **Border radius:** 20dp

**Single Pill (Selected State):**
- **Background:** #CBFFC9 (from LimeGreenBright)
- **Border:** 1dp solid #A8E6CF (from LimeGreenDark)
- **Text color:** #000000 (from TextOnLight)
- All other properties same

**Categories:**
- All, Chest, Back, Legs, Shoulders, Arms, Core

**Behavior:**
- Only one category selected at time
- "All" selected by default
- **Works in combination with search filter** (hybrid approach)
- Category + Search = combined filter (shows exercises matching both)

#### Exercise List
**Background:** #F3F3F8 (from LightLavenderGray)
**Padding:** Horizontal 16dp
**Padding bottom:** 88dp (8dp grid aligned, prevents FAB overlap)
**Scrollable:** Vertical (LazyColumn for performance)

**Exercise Card (Default State)**

**Container:**
- **Background:** #FFFFFF (from LightSurface)
- **Border radius:** 12dp
- **Padding:** 16dp
- **Margin bottom:** 8dp
- **Shadow:** Elevation 1dp

**Exercise Name:**
- Text: Exercise name (e.g., "Bench Press")
- Font: 16sp / Medium
- Color: #000000 (from TextOnLight)

**Category Label** (below name):
- Text format: "[Category] · [Equipment]"
- Example: "Chest · Barbell"
- Font: 14sp / Medium (improved from Regular for better scanning)
- Color: #4A4A4A (WCAG AA compliant for quick gym scanning)
- Padding top: 4dp

**Behavior (Context-Aware):**

**NORMAL mode (Active Workout):**
- Tap card → Adds exercise to workout
- **Haptic:** Medium impact (Brand DNA compliance - equivalent to "set saved")
- Toast confirmation appears (see Toast section below)
- Card transitions to "Added" state (checkmark)
- User can continue adding more exercises

**ADDING_MODE (Plan Builder Days — "Quick Add with Smart Defaults"):**
- Tap card → **Immediately adds exercise** with smart defaults (NO Target Config popup!)
- Smart defaults priority: User history > AI suggestion > Fallback (3×10 @ Bodyweight)
- **Smart Toast appears** showing what was added + option to configure
- Card shows checkmark (exercise added to this day)
- Counter updates: "Adding to Push · [X+1] added"
- User can:
  - Tap [Configure] in toast → Opens Target Config (5.04) to adjust
  - Tap [Got it] or wait → Toast dismisses, continue adding
  - Tap "Done (X)" when finished → Returns to Plan Builder Days (5.03)

**Brand DNA Alignment:**
- ✅ **Optimistic UI**: Exercise added instantly, no waiting
- ✅ **Smart Defaults**: Pre-fill, don't ask. Never show blank cell.
- ✅ **Zero Friction**: One tap to add, configure only if wanted

**REPLACE mode (Plan Builder Days):**
- Tap card → Opens Target Config (5.04) bottom sheet
- Target Config opens in "replace" mode with new exercise
- User configures sets/reps/weight for new exercise
- On save: Old exercise is replaced with new one (including new targets)
- After saving targets → Returns to Plan Builder Days (5.03)
- Old exercise replaced with new one
- NO checkmark in Exercise Picker (replace is one-time action)

**Exercise Card (Added State - NORMAL Mode Only)**

**Context:** Only applies in NORMAL mode (Active Workout). In ADDING_MODE, cards show checkmark for exercises added in current session. In REPLACE mode, cards never show "Added" state.

**Visual Changes:**
- **Opacity:** 90% (slight dimming)
- **Checkmark icon:** Appears on right side
  - Icon: `check` (✓)
  - Color: #A8E6CF (from LimeGreenDark)
  - Size: 20dp
  - Position: Center-right, 16dp from right edge
  - Vertical alignment: Center

**Interaction:**
- **Tap behavior:** Disabled (non-tappable)
- **Feedback:** Toast appears: "Already in your workout" (2 seconds)

#### FAB (Floating Action Button)

**Default Appearance:**

**Container:**
- **Shape:** Circle
- **Size:** 56dp diameter
- **Background:** #A8E6CF (from LimeGreenDark)
- **Shadow:** Elevation 6dp
- **Position:** 16dp from right edge, 72dp from bottom edge (improved thumb zone reach)

**Icon:**
- Icon: `add` (+)
- Color: #1A1A1A (from TextOnLightCard)
- Size: 24dp
- Centered in FAB

**Behavior:**
- Tap → Opens Create Exercise bottom sheet

**FAB Animation (Hide/Show on Scroll)**

**Hide (Scroll Down):**
- TranslateY: 0dp → +88dp
- Opacity: 1 → 0
- Duration: 200ms
- Easing: FastOutLinearIn (accelerates)
- **Trigger:** User scrolls down >10dp

**Show (Scroll Up):**
- TranslateY: +88dp → 0dp
- Opacity: 0 → 1
- Duration: 200ms
- Easing: Spring (dampingRatio = 0.7, slight bounce)
- **Trigger:** User scrolls up >10dp

#### Loading State
**Trigger:** Initial exercise library fetch or search query processing

**Skeleton Cards:**

**Appearance:**
- 5 skeleton cards visible (fills viewport)
- Same card structure as exercise cards
- All content areas replaced with animated shimmer placeholders

**Skeleton Card Structure:**
- **Container:** Same as exercise card (white, 12dp radius, 16dp padding)
- **Title placeholder:**
  - Width: 60% of card width
  - Height: 16dp
  - Background: #E5E5E5 (from GrayBorder)
  - Border radius: 4dp
- **Subtitle placeholder:**
  - Width: 40% of card width
  - Height: 12dp
  - Background: #E5E5E5 (from GrayBorder)
  - Border radius: 4dp
  - Margin top: 8dp

**Shimmer Animation:**
- Gradient sweep from left to right
- Duration: 1500ms per cycle
- Gradient: #E5E5E5 → #F3F3F8 → #E5E5E5
- Easing: Linear, infinite loop

#### Empty States

**No Results (Search + Filter)**

**Position:** Center of exercise list area

**Empty Icon (Optional):**
- Icon: `search_off` or empty illustration
- Color: #B0B0B0 (from TextOnDarkTertiary)
- Size: 64dp
- Margin bottom: 16dp
- Centered horizontally

**Message:**
- Text: "No exercises found for selected criteria"
- Font: 16sp / Regular
- Color: #4A4A4A (WCAG AA compliant placeholder text)
- Alignment: Center
- Padding: 24dp

**Button (Appears when search has text - Hybrid Approach):**
- Text format: "Create '[Query]'"
- Example: "Create 'Goblet Squat'"
- **Background:** #A8E6CF (from LimeGreenDark)
- **Text color:** #1A1A1A (from TextOnLightCard)
- **Font:** 16sp / Medium
- **Padding:** Vertical 14dp
- **Border radius:** 12dp
- **Width:** Full width (minus 32dp margins)
- **Behavior:** Opens bottom sheet with name pre-filled

**Error State (Can't Load Library)**

**Scenario:** First launch, no internet, exercise library fails to load

**Icon:**
- Icon: `error` or alert symbol
- Color: #FF9999 (from CoralPink)
- Size: 64dp
- Centered, margin bottom 16dp

**Message:**
- Text: "We couldn't load the exercise library"
- Font: 16sp / Medium
- Color: #000000 (from TextOnLight)
- Alignment: Center
- Margin bottom: 8dp

**Subtitle:**
- Text: "Check your connection and try again, or create custom exercises to get started"
- Font: 14sp / Regular
- Color: #666666 (from TextOnLightTertiary)
- Alignment: Center
- Margin bottom: 24dp

**Buttons (Stacked):**

1. **"Retry" button** (primary):
   - Background: #A8E6CF (from LimeGreenDark)
   - Text: "Retry"
   - Text color: #1A1A1A (from TextOnLightCard)
   - Font: 16sp / Bold
   - Full width
   - Margin bottom: 12dp

2. **"Create Custom Exercise" button** (secondary):
   - Background: Transparent
   - Border: 2dp solid #A8E6CF (from LimeGreenDark)
   - Text: "Create Custom Exercise"
   - Text color: #A8E6CF (from LimeGreenDark)
   - Font: 16sp / Medium
   - Full width

#### Create Exercise Bottom Sheet
**Trigger:**
- User taps FAB
- OR user taps "Create '[Query]'" button (from no results state)

**Bottom Sheet Container:**

**Appearance:**
- **Background:** #FFFFFF (from LightSurface)
- **Border radius:** Top corners 20dp
- **Height:** ~280dp (auto-sized to content)
- **Padding:** 24dp all sides
- **Shadow:** Elevation 8dp

**Backdrop:**
- Semi-transparent black, 50% opacity
- Tap outside → Dismisses sheet

**Drag Handle (Top):**
- Width: 32dp
- Height: 4dp
- Color: #E5E5E5 (from GrayBorder)
- Centered, 8dp from top
- **Behavior:** Drag down → Dismisses sheet

**Bottom Sheet Content:**

**Header:**
- Text: "Create Custom Exercise"
- Font: 20sp / Bold
- Color: #000000 (from TextOnLight)
- Margin bottom: 24dp

**Form Field (ONE FIELD ONLY):**

**Label:**
- Text: "Exercise Name"
- Font: 12sp / Regular
- Color: #666666 (from TextOnLightTertiary)
- Margin bottom: 6dp

**Input:**
- **Background:** #F3F3F8 (from LightLavenderGray)
- **Border:** 1dp solid #E5E5E5 (from GrayBorder)
- **Border radius:** 8dp
- **Text color:** #000000 (from TextOnLight)
- **Font:** 16sp / Medium (consistent with search bar input)
- **Padding:** 12dp
- **Placeholder:** "e.g., Goblet Squat"
- **Auto-focus:** Yes (keyboard opens automatically)
- **Pre-filled:** If from "Create '[Query]'" button, name is pre-filled with search query

**Focus State:**
- Border color: #A8E6CF (from LimeGreenDark)
- Border width: 2dp

**Primary Button:**
- Text: "Create Exercise"
- **Background:** #A8E6CF (from LimeGreenDark)
- **Text color:** #1A1A1A (from TextOnLightCard)
- **Font:** 16sp / Bold
- **Padding:** Vertical 14dp
- **Border radius:** 12dp
- **Width:** Full width
- **Shadow:** Elevation 2dp
- **Margin top:** 16dp

**Enabled State:**
- Condition: Name field not empty
- Tappable: Yes

**Disabled State:**
- Background: #E5E5E5 (from GrayBorder)
- Text color: #999999 (from GrayMuted)
- Tappable: No
- Shadow: None
- Condition: Name field empty

**Cancel Button:**
- Text: "Cancel"
- **Background:** Transparent
- **Text color:** #4A4A4A (WCAG AA compliant - 5.9:1 contrast)
- **Font:** 14sp / Medium
- **Padding:** Vertical 12dp
- **Margin top:** 12dp
- **Behavior:** Dismisses sheet, no changes

**Create Exercise Behavior:**

**On "Create Exercise" tap:**

1. ✅ Validate name not empty
2. ✅ Create exercise in local database
3. ✅ Backend auto-assigns category/equipment (AI-powered)
4. ✅ Add exercise to current workout (queued state)
5. ✅ Close bottom sheet
6. ✅ Return to Exercise Picker
7. ✅ Show exercise in list with checkmark
8. ✅ Show toast (see below)

#### Toast System (Context-Aware with Quick Actions)

**Design Philosophy:**
Users building workouts on-the-fly need fast paths. The toast system provides:
1. **Action Toast** - For first exercise (or after returning from Exercise Detail), offers "Start Now" or "Add More"
2. **Simple Toast** - For subsequent exercises when user is in batch-add mode
3. **Warning Toast** - For already-added exercises

---

### Toast State Logic

**State Logic (Per-Session):**
- Track whether user has chosen "Add More" (resets when leaving Exercise Picker)
- **First exercise added**: Show Action Toast with buttons (Start Now / Add More)
- **If user tapped "Add More"**: Show Simple Toast for all subsequent exercises (auto-dismiss)
- **If user taps "Start Now"**: Navigate to Exercise Detail, reset the "Add More" flag
- **When leaving picker** (back arrow or Start Now): Reset the flag

**State Flow Diagram:**
```
┌─────────────────────────────────────────────────────────────┐
│                    FIRST EXERCISE ADDED                      │
│                              ↓                               │
│              Action Toast (Start Now / Add More)             │
│                      ↙            ↘                          │
│              [Start Now]        [Add More]                   │
│                   ↓                  ↓                       │
│           → Exercise Detail    Toast dismissed               │
│                   ↓                  ↓                       │
│           (user logs sets)     userChoseAddMore = true       │
│                   ↓                  ↓                       │
│           Returns to Picker    SUBSEQUENT EXERCISES          │
│                   ↓                  ↓                       │
│           Reset: userChose     Simple Toast only             │
│           AddMore = false      (auto-dismiss, 2 sec)         │
└─────────────────────────────────────────────────────────────┘
```

---

### Action Toast (Primary - With Quick Actions)

**Trigger:**
- First exercise added after entering picker
- First exercise added after returning from Exercise Detail
- Custom exercise created via bottom sheet

**Visual Structure:**
```
┌─────────────────────────────────────────────────────────────┐
│▌                                                            │
│▌   ✓  Bench Press added                                     │
│▌                                                            │
│▌   ┌─────────────┐        ┌─────────────┐                   │
│▌   │  Start Now  │        │  Add More   │                   │
│▌   └─────────────┘        └─────────────┘                   │
│▌                                                            │
└─────────────────────────────────────────────────────────────┘
```

**Container:**
- **Background:** #2D3142 (from DarkNavy, 100% opacity)
- **Width:** Full screen width (0dp margins)
- **Height:** ~120dp (auto-sized to content)
- **Border radius:** 12dp top-left, 12dp top-right, 0dp bottom corners
- **Shadow:** Elevation 6dp
- **Position:** Flush with bottom of screen, above safe area inset
- **Auto-dismiss:** DISABLED (requires user action or swipe)

**Left Accent Bar:**
- **Width:** 6dp
- **Height:** Full container height
- **Color:** #A8E6CF (from LimeGreenDark)
- **Border radius:** 12dp top-left, 0dp bottom-left

**Header Row (Icon + Text):**
- **Padding top:** 16dp

**Success Icon:**
- **Icon:** `check_circle` (filled)
- **Size:** 24dp
- **Color:** #A8E6CF (from LimeGreenDark)
- **Margin right:** 8dp

**Text:**
- **Text format:** "[Exercise Name] added"
- **Example:** "Bench Press added"
- **Color:** #FFFFFF (from TextOnDark)
- **Font:** 16sp / Medium
- **Max lines:** 1
- **Ellipsize:** End (if name too long)

**Button Row:**
- **Layout:** Horizontal, centered
- **Gap:** 12dp between buttons
- **Padding top:** 16dp
- **Padding bottom:** 16dp + safe area inset

**"Start Now" Button (Primary):**
- **Background:** #A8E6CF (from LimeGreenDark)
- **Text:** "Start Now"
- **Text color:** #1A1A1A (from TextOnLightCard)
- **Font:** 14sp / Bold
- **Padding:** 12dp horizontal, 10dp vertical
- **Border radius:** 8dp
- **Min width:** 120dp
- **Behavior:**
  - Navigate to Exercise Detail screen for this exercise
  - Exercise becomes "In Progress"
  - On return to picker, reset `userChoseAddMore = false`
- **Haptic:** Medium impact on tap

**"Add More" Button (Secondary):**
- **Background:** Transparent
- **Border:** 1.5dp solid #666666
- **Text:** "Add More"
- **Text color:** #FFFFFF (from TextOnDark)
- **Font:** 14sp / Medium
- **Padding:** 12dp horizontal, 10dp vertical
- **Border radius:** 8dp
- **Min width:** 120dp
- **Behavior:**
  - Dismiss toast
  - Set `userChoseAddMore = true`
  - Stay in Exercise Picker
- **Haptic:** Light impact on tap

**Swipe to Dismiss:**
- **Gesture:** Swipe down on toast
- **Behavior:** Same as tapping "Add More"
- **Animation:** Slide down + fade out (200ms)

---

### Simple Toast (Secondary - Batch Add Mode)

**Trigger:**
- 2nd, 3rd, 4th... exercise added AFTER user tapped "Add More"
- Only shown when `userChoseAddMore = true`

**Visual Structure:**
```
┌─────────────────────────────────────────────────────────────┐
│▌                                                            │
│▌         ✓   Squat added                                ×   │
│▌                                                            │
└─────────────────────────────────────────────────────────────┘
```

**Container:**
- **Background:** #2D3142 (from DarkNavy, 100% opacity)
- **Width:** Full screen width (0dp margins)
- **Height:** 56dp
- **Border radius:** 12dp top-left, 12dp top-right, 0dp bottom corners
- **Shadow:** Elevation 6dp
- **Position:** Flush with bottom of screen, above safe area inset
- **Auto-dismiss:** YES, after 2 seconds

**Left Accent Bar:**
- **Width:** 6dp
- **Height:** Full container height
- **Color:** #A8E6CF (from LimeGreenDark)
- **Border radius:** 12dp top-left, 0dp bottom-left

**Content Area:**
- **Max width:** 320dp
- **Alignment:** Centered horizontally within container
- **Layout:** Icon + Text + Dismiss icon

**Success Icon:**
- **Icon:** `check_circle` (filled)
- **Size:** 24dp
- **Color:** #A8E6CF (from LimeGreenDark)

**Text:**
- **Text format:** "[Exercise Name] added"
- **Example:** "Squat added"
- **Color:** #FFFFFF (from TextOnDark)
- **Font:** 16sp / Medium
- **Position:** 8dp from icon
- **Max lines:** 1
- **Ellipsize:** End

**Dismiss Icon (Right):**
- **Icon:** `close` (×)
- **Size:** 20dp
- **Color:** #B0B0B0 (from TextOnDarkTertiary)
- **Touch target:** 48dp × 48dp
- **Position:** Right edge of content area
- **Behavior:** Dismiss toast immediately

**Padding:**
- **Vertical:** 16dp top, 16dp bottom + safe area inset
- **Horizontal:** 16dp

---

### Warning Toast (Already Added)

**Trigger:** User taps exercise card that's already added (has checkmark)

**Visual Structure:**
```
┌─────────────────────────────────────────────────────────────┐
│▌                                                            │
│▌         ⚠   Already in your workout                    ×   │
│▌                                                            │
└─────────────────────────────────────────────────────────────┘
```

**Container:**
- Same as Simple Toast
- **Auto-dismiss:** YES, after 2 seconds

**Left Accent Bar:**
- **Color:** #FF9944 (WCAG AA compliant warning orange)

**Warning Icon:**
- **Icon:** `warning` (filled)
- **Size:** 24dp
- **Color:** #FF9944

**Text:**
- **Text:** "Already in your workout"
- **Color:** #FFFFFF
- **Font:** 16sp / Medium

---

### Custom Exercise Created Toast

**Trigger:** User creates custom exercise via bottom sheet

**Toast Type:** Action Toast (same as first exercise added)

**Text:** "Created [Name]"
- **Example:** "Created Goblet Squat"

**Subtext (below main text):**
- **Text format:** "[Category] category"
- **Example:** "Legs category"
- **Font:** 14sp / Regular
- **Color:** #B0B0B0 (from TextOnDarkTertiary)
- **Margin top:** 4dp

**Buttons:** Same "Start Now" / "Add More" as Action Toast

**Behavior:** Same state logic - if user taps "Add More", subsequent custom exercises show Simple Toast.

---

### FAB Interaction

**When toast appears:**
- FAB shifts up by toast height + 8dp gap
- Animation: 200ms, FastOutSlowIn
- FAB remains visible and tappable

**When toast disappears:**
- FAB returns to original position
- Animation: 200ms, FastOutSlowIn

---

### Toast Animation

**Entrance (All Toast Types):**
- Slide up from bottom: TranslateY +100% → 0
- Duration: 200ms
- Easing: FastOutSlowIn

**Exit (All Toast Types):**
- Slide down: TranslateY 0 → +100%
- Duration: 200ms
- Easing: FastOutLinearIn

---

### Toast Variants Summary Table

| Scenario | Toast Type | Auto-dismiss | Duration | Buttons |
|----------|------------|--------------|----------|---------|
| 1st exercise added | Action Toast | NO | Until action | Start Now / Add More |
| After returning from Exercise Detail | Action Toast | NO | Until action | Start Now / Add More |
| 2nd+ exercise (after "Add More") | Simple Toast | YES | 2 sec | None (× dismiss only) |
| Already added (re-tap) | Warning Toast | YES | 2 sec | None (× dismiss only) |
| Custom exercise created | Action Toast | NO | Until action | Start Now / Add More |

</exercise_picker_screen>

### <exercise_picker_dark_mode>

**Context:** Dark Mode is the "Hero" experience (Brand DNA). All specs below apply to dark theme.

---

#### Top Bar (Dark Mode)

**Appearance:**
- **Background:** #2D3142 (DarkNavy from branding.md)
- **Shadow:** Elevation 2dp (#000000 at 50% opacity)
- **Padding:** 16dp horizontal

**Back Arrow:**
- Color: #FFFFFF (Text Primary on dark)
- All other specs same as light mode

**Title:**
- Color: #FFFFFF
- All other specs same as light mode

**Network Badge:**
- Follows dark mode component spec

---

#### Search Bar (Dark Mode)
**See <search_bar_dark_mode> section above** (already specified)

---

#### Category Pills (Dark Mode)

**Container (Scrollable):**
- Background: Transparent
- Same layout as light mode

**Single Pill (Default State):**
- **Background:** #3A3F52 (elevated surface on dark)
- **Border:** 1dp solid #4A4F62
- **Text color:** #FFFFFF
- **Font:** 14sp / Medium
- **Padding:** Horizontal 16dp, Vertical 8dp
- **Border radius:** 20dp

**Single Pill (Selected State):**
- **Background:** #A8E6CF (Brand Mint - pops on dark)
- **Border:** None
- **Text color:** #1A1A1A (dark text on bright background)
- All other specs same

**Behavior:** Same as light mode

---

#### Content Area (Dark Mode)

**Background:** #2D3142 (DarkNavy - matches top bar)
**Padding:** Same as light mode
**Scrollable:** Vertical

---

#### Exercise List (Dark Mode)

**Exercise Card (Default State):**

**Container:**
- **Background:** #3A3F52 (elevated card on dark)
- **Border radius:** 12dp
- **Padding:** 16dp
- **Margin bottom:** 8dp
- **Shadow:** Elevation 2dp (#000000 at 40% opacity, blur 4dp)

**Exercise Name:**
- Text: Dynamic (e.g., "Bench Press")
- Font: 16sp / Medium
- Color: #FFFFFF (Text Primary on dark)

**Category Label:**
- Text: "[Category] · [Equipment]"
- Font: 14sp / Medium
- Color: #B8BCC8 (Text Secondary on dark)
- Padding top: 4dp

**Behavior:** Same as light mode (context-aware)

**Exercise Card (Added State - NORMAL Mode Only):**

**Visual Changes:**
- **Opacity:** 90%
- **Checkmark icon:**
  - Icon: `check` (✓)
  - Color: #A8E6CF (Brand Mint - glows on dark)
  - Size: 20dp
  - Position: Center-right, 16dp from right edge

**Interaction:** Same as light mode

---

#### FAB (Dark Mode)

**Container:**
- **Background:** #A8E6CF (Brand Mint - same as light, pops on dark)
- **Icon color:** #1A1A1A (dark icon on bright button)
- All other specs same as light mode

**Animation:** Same as light mode

---

#### Loading State (Dark Mode)

**Skeleton Cards:**
- **Container:** #3A3F52 (elevated card background)
- **Shimmer gradient:** #3A3F52 → #4A4F62 → #3A3F52 (lighter on dark)
- **Animation:** Same timing as light mode

---

#### Empty States (Dark Mode)

**No Results:**
- **Icon color:** #666666 (dimmer on dark)
- **Message color:** #B8BCC8 (Text Secondary on dark)
- **Button background:** #A8E6CF (Brand Mint)
- **Button text color:** #1A1A1A

**Error State:**
- **Icon color:** #FF9999 (CoralPink)
- **Message color:** #FFFFFF
- **Subtitle color:** #B8BCC8
- **Primary button:** #A8E6CF background, #1A1A1A text
- **Secondary button:** Transparent background, #A8E6CF border + text

---

#### Create Exercise Bottom Sheet (Dark Mode)

**Container:**
- **Background:** #2D3142 (DarkNavy)
- **Border radius:** 20dp (top corners)
- **Shadow:** Elevation 8dp (#000000 at 50% opacity)

**Backdrop:** Same as light mode (semi-transparent black)

**Drag Handle:**
- Color: #4A4F62 (lighter than background)

**Header Text:**
- Color: #FFFFFF
- All other specs same

**Form Field:**

**Label:**
- Color: #B8BCC8 (Text Secondary on dark)

**Input:**
- **Background:** #3A3F52 (elevated surface)
- **Border:** 1dp solid #4A4F62
- **Text color:** #FFFFFF
- **Placeholder color:** #B8BCC8

**Focus State:**
- Border color: #A8E6CF (Brand Mint)
- Border width: 2dp

**Primary Button:**
- Background: #A8E6CF (Brand Mint)
- Text color: #1A1A1A
- All other specs same

**Disabled State:**
- Background: #3A3F52
- Text color: #666666

**Cancel Button:**
- Background: Transparent
- Text color: #B8BCC8

---

#### Toast System (Dark Mode)

**Note:** Toast system is designed dark-mode-first. All specs in the main section already use dark mode colors (#2D3142 background, #FFFFFF text).

**Action Toast Buttons (Dark Mode):**

**"Start Now" Button:**
- Background: #A8E6CF (Brand Mint - pops on dark)
- Text color: #1A1A1A (dark text on bright button)

**"Add More" Button:**
- Background: Transparent
- Border: 1.5dp solid #666666 (visible on dark)
- Text color: #FFFFFF

**Accent Bar Colors:**
- Success: #A8E6CF (Brand Mint)
- Warning: #FF9944

**Icons:**
- Success: #A8E6CF
- Warning: #FF9944

**Text:**
- Primary: #FFFFFF
- Subtext: #B0B0B0 (TextOnDarkTertiary)

**Dismiss Icon:**
- Color: #B8BCC8

---

### </exercise_picker_dark_mode>

---

## 4. Notes
*   **Design Philosophy**:
    *   **No helper tips**: User chose "train on my own" = confident.
    *   **Context-aware toasts**: Provide guidance only when needed.
    *   **Minimal friction**: One field for custom exercises, AI handles rest.
    *   **Hybrid approach**: Search + category filters work together.
*   **Accessibility Features**:
    *   **Contrast**: #4A4A4A used for placeholders/subtext to meet WCAG AA.
    *   **Touch Targets**: Minimum 48dp for all interactive elements.
    *   **Screen Reader**: Clear announcements for loading, empty states, and toast messages.
    *   **Reduced Motion**: Support for disabling animations.
*   **Developer Notes**:
    *   **Offline-First**: Exercise library cached locally.
    *   **Performance**: Use `LazyColumn` and `LazyRow`. Debounce search input (300ms).
    *   **State Management**: `ExercisePickerState` holds exercises, selection, query, etc.
    *   **Search Logic**: `filterExercises` combines category and search query.
    *   **Theme Support (NEW)**:
        *   **Dark Mode First**: Brand DNA states "Dark Mode is Hero" - design/test dark mode first.
        *   **System Theme Detection**: Follow system setting (auto switch Light/Dark).
        *   **Override Option**: Allow user to force Light/Dark in settings (future).
        *   **Color Tokens**: Use semantic tokens from branding.md (not hardcoded hex).
    *   **Search Field (REDESIGNED)**:
        *   **Accessibility**: Placeholder contrast meets WCAG AA (5.74:1 on light, 7.2:1 on dark).
        *   **Prominence**: White background (light) / elevated surface (dark) with brand border.
        *   **Focus Animation**: Border width 2dp → 3dp with glow on dark mode.
        *   **Placeholder**: "What are we crushing today?" (gym personality + context).
    *   **Haptic Feedback (NEW - Brand DNA Compliance)**:
        *   **Exercise Added (NORMAL mode)**: Medium impact (equivalent to "set saved").
        *   **Search Clear Button**: Light impact on tap.
        *   **FAB Tap**: Medium impact (creating custom exercise).
        *   **Category Pill Selection**: Light impact (future enhancement).
    *   **Context Modes (NEW)**:
        *   **Mode Detection**: Pass `PickerMode` enum via navigation args.
        *   **Header Updates**: Title changes based on mode (see Top Bar section).
        *   **Tap Behavior**: NORMAL → Add to workout, ADD_TO_DAY/REPLACE → Navigate to Target Config.
        *   **No Checkmarks**: In ADD_TO_DAY/REPLACE modes, never show "Added" state (user can pick same exercise for multiple days).
        *   **Back Navigation**: Context-aware return (Active Workout vs Plan Preview).
    *   **Integration with Target Config (5.04)**:
        *   When user taps exercise in ADD_TO_DAY/REPLACE mode, open Target Config bottom sheet.
        *   Pass exercise reference and context (dayIndex, oldExerciseIndex if replacing).
        *   On Target Config save, return to Plan Preview with configured targets.
    *   **FAB Position (UPDATED)**:
        *   Moved to 72dp from bottom (was 24dp) for better thumb zone reach.
        *   Accounts for safe area inset + comfortable reach on large devices.
    *   **Edge Cases**:
        *   **Duplicate Custom Exercise**: Allow creation, show toast.
        *   **No Results**: Show empty state but keep filters visible.
        *   **Many Additions (NORMAL mode)**: No limit, all show checkmarks.
        *   **Same Exercise to Multiple Days (ADD_TO_DAY)**: Allowed, no visual feedback in picker.
    *   **Toast State Management (NEW)**:
        *   Track `userChoseAddMore: Boolean` per picker session.
        *   Reset state when user leaves picker (back arrow or "Start Now").
        *   Action Toast requires explicit user action (no auto-dismiss).
        *   Simple Toast auto-dismisses after 2 seconds.

---

## Revision History

### <adding_mode_spec>

**ADDING MODE — Full Specification (Stay in Picker Pattern)**

> **Required for:** Plan Builder Days (5.03) integration
> **Status:** ✅ COMPLETE

---

#### Context Header (Below Top Bar)

**Position:** Below top bar, above search bar

**Container:**
- Background: #D4D0E8 at 10% opacity (LavenderMedium — Intelligence context)
- Padding: 12dp 16dp
- Border radius: 8dp
- Margin: 8dp 16dp

**Content:**
- Text: "Adding to [Day Name] · [X] added"
- Example: "Adding to Push · 3 added"
- Font: 14sp / Medium
- Color: #D4D0E8 (Dark mode) / #6B5B95 (Light mode)

**Counter Animation:**
- On each exercise added: Counter bumps (scale 1.0 → 1.2 → 1.0, 200ms spring)
- Haptic: Light impact on increment

---

#### Added Exercise Indicator (On Exercise Cards)

**Visibility:** Only in ADDING_MODE, for exercises already added to this day

**Checkmark Badge (Top-Right of Card):**
- Icon: Material Symbol `check_circle` (Filled, weight 500)
- Size: 24dp
- Color: #A8E6CF (LimeGreenDark)
- Position: Top-right corner, 8dp from edges
- Background: #2D3142 circle (32dp diameter) for contrast
- Animation: Scale 0 → 1.0 with spring bounce when added (300ms)

**Card State (Already Added):**
- Border: 1dp solid #A8E6CF at 30% opacity
- Opacity: 95% (slight dim to indicate "already picked")
- Tap behavior: Still tappable — opens Target Config to re-configure targets

---

#### "Done (X)" Button (Fixed Bottom Bar)

**Position:** Fixed at bottom of screen (above safe area)

**Container:**
- Background: #2D3142 (Dark) / #FFFFFF (Light)
- Padding: 16dp
- Border top: 1dp solid #3A3F52 (Dark) / #E5E5E5 (Light)
- Height: 72dp (includes safe area padding)

**Button:**
- Background: #A8E6CF (LimeGreenDark — Primary Action)
- Border radius: 12dp
- Height: 56dp
- Width: Full width minus 32dp (16dp margins)
- Shadow: Elevation 4dp
- Glow: 0dp 0dp 16dp #A8E6CF at 30% opacity

**Text:**
- Text: "Done ([X])" where X = number of exercises added
- Example: "Done (3)"
- Font: 18sp / Bold
- Color: #1A1A1A

**If X = 0:**
- Text: "Done" (without count)
- Still enabled (user can exit without adding anything)

**Tap Behavior:**
1. Haptic: Medium impact
2. Save all added exercises (already auto-saved via Target Config)
3. Navigate to Plan Builder Days (5.03)
4. Day card remains expanded
5. New exercises visible in exercise list

---

#### Back Arrow Behavior (ADDING_MODE)

**Tap Back Arrow:**
- Same as tapping "Done (X)" — returns to Plan Builder Days
- Does NOT show "discard" confirmation (exercises already saved via Target Config)
- Rationale: Each exercise was explicitly saved, so no data loss risk

---

#### State Management

**State Required for ADDING_MODE:**
- **Day ID**: Reference to the day being configured
- **Day Name**: Display name for header (e.g., "Push", "Leg Day")
- **Added Count**: Number of exercises added in this session (for counter display)
- **Added Exercise IDs**: List of IDs for checkmark display on cards

**On Exercise Selected (Quick Add Flow):**
1. Exercise is immediately added to day with smart defaults
2. Smart Toast appears confirming addition
3. Added count increments
4. Exercise ID added to checkmark list
5. User stays in Exercise Picker (no navigation)
6. If user taps [Configure] in toast → Target Config opens → returns here after save

**On "Done (X)" Tap:**
1. Navigate to Plan Builder Days (5.03)
2. Pass expanded day ID so the day card remains expanded
3. New exercises visible in the exercise list

---

### </adding_mode_spec>

---

### <smart_add_toast>

**SMART ADD TOAST — Quick Add Confirmation (ADDING_MODE only)**

> **Trigger:** User taps exercise card in ADDING_MODE
> **Purpose:** Confirm addition, show smart defaults, offer optional configuration

---

#### Toast Container

**Appearance:**
- Background: #2D3142 (DarkNavy)
- Width: Full screen width
- Height: ~100dp (auto-sized to content)
- Border radius: 12dp top corners, 0dp bottom
- Shadow: Elevation 6dp
- Position: Fixed at bottom, above "Done (X)" button
- Safe area: Respected

**Left Accent Bar:**
- Width: 6dp
- Height: Full container height
- Color: #A8E6CF (LimeGreenDark)
- Border radius: 12dp top-left

---

#### Toast Content

**Header Row:**
- Padding: 16dp

**Success Icon:**
- Icon: Material Symbol `check_circle` (Filled)
- Size: 24dp
- Color: #A8E6CF

**Exercise Name:**
- Text: "[Exercise Name] added"
- Font: 16sp / Medium
- Color: #FFFFFF
- Margin left: 8dp

**Targets Line (Below Name):**
- Text: "[sets]×[reps] @ [weight]" (e.g., "3×10 @ 50kg")
- Font: 14sp / Regular
- Color: #B8BCC8
- Margin top: 4dp

**Source Indicator (Optional, after targets):**
- If from history: "(from last workout)"
- If from AI/fallback: "(suggested)"
- Font: 12sp / Regular
- Color: #666666

---

#### Toast Variants

**Variant A: From User History**
```
┌─────────────────────────────────────────────────────────────────┐
│▌  ✓  Bench Press added                                         │
│▌     3×10 @ 50kg (from last workout)                           │
│▌                                                                │
│▌     [Configure]                    [Got it]                   │
└─────────────────────────────────────────────────────────────────┘
```

**Variant B: From AI / Fallback**
```
┌─────────────────────────────────────────────────────────────────┐
│▌  ✓  Romanian Deadlift added                                   │
│▌     3×12 @ Bodyweight (suggested)                             │
│▌                                                                │
│▌     [Configure]                    [Got it]                   │
└─────────────────────────────────────────────────────────────────┘
```

**Variant C: After Configuring (user already tapped Configure)**
```
┌─────────────────────────────────────────────────────────────────┐
│▌  ✓  Lateral Raises added                                      │
│▌     4×15 @ 10kg                                               │
│▌                                                                │
│▌                                    [Got it]                   │
└─────────────────────────────────────────────────────────────────┘
```
Note: No [Configure] button — user just configured it.

---

#### Buttons

**[Configure] Button (Left):**
- Background: Transparent
- Border: 1.5dp solid #A8E6CF
- Text: "Configure"
- Text color: #A8E6CF
- Font: 14sp / Medium
- Padding: 10dp 16dp
- Border radius: 8dp
- Min width: 100dp

**Tap Behavior:**
1. Haptic: Light impact
2. Opens Target Config (5.04) as bottom sheet
3. Pre-filled with current smart defaults
4. After save → Returns to Exercise Picker
5. Toast updates to Variant C (no Configure button)

**[Got it] Button (Right):**
- Background: #A8E6CF
- Text: "Got it"
- Text color: #1A1A1A
- Font: 14sp / Bold
- Padding: 10dp 20dp
- Border radius: 8dp
- Min width: 100dp

**Tap Behavior:**
1. Haptic: Light impact
2. Toast dismisses (slide down, 200ms)
3. User continues in Exercise Picker

---

#### Auto-Dismiss Behavior

**If user does nothing:**
- Toast auto-dismisses after **4 seconds**
- Same as tapping [Got it]
- Exercise remains added with smart defaults

**If user taps another exercise:**
- Current toast dismisses immediately
- New exercise added
- New toast appears for new exercise

---

#### Toast Queue (Multiple Rapid Adds)

**If user adds exercises rapidly (before toast dismisses):**
- Only show toast for most recent exercise
- Previous exercises silently added with smart defaults
- Counter updates correctly: "Adding to Push · 3 added"

**Rationale:** User is in "flow state," don't interrupt with multiple toasts.

---

### </smart_add_toast>

---

### 2025-01-XX: Quick Add with Smart Defaults
- **CHANGED**: ADDING_MODE no longer auto-opens Target Config
- **ADDED**: Smart Add Toast with [Configure] / [Got it] buttons
- **ADDED**: Smart defaults priority (history > AI > fallback)
- **RATIONALE**: Aligns with Brand DNA — "Optimistic UI," "Smart Defaults," "Zero Friction"

### 2025-01-XX: ADDING_MODE Completion & Navigation Updates
- **COMPLETED**: Full `<adding_mode_spec>` for "Stay in Picker" pattern
- **ADDED**: Context Header ("Adding to [Day Name] · [X] added")
- **ADDED**: "Done (X)" fixed bottom button
- **ADDED**: Checkmark badge for already-added exercises
- **RENAMED**: `ADD_TO_DAY` mode → `ADDING_MODE` (reflects behavior better)
- **UPDATED**: All navigation references from Plan Preview (1.07) to Plan Builder Days (5.03)
- **UPDATED**: Back button behavior for ADDING_MODE
- **RATIONALE**: Exercise Picker now integrates with Plan Builder via "Stay in Picker" pattern

---

### 2025-11-25: Action Toast System (Quick Actions)
- **ADDED**: Action Toast with "Start Now" / "Add More" buttons
- **ADDED**: Simple Toast for batch-add mode (after user taps "Add More")
- **ADDED**: Toast state logic (`userChoseAddMore` flag)
- **UPDATED**: Custom exercise creation now shows Action Toast
- **PURPOSE**: Reduce friction for "add one, do one" workout flow
- **RATIONALE**: New users building workouts on-the-fly need fast paths from exercise picker to set logging

### 2025-01-11: UX Review & Redesign
- Removed Exercise Action Sheet modal (eliminated friction)
- Added FAB with animated hide/show for custom exercise creation
- Added context-aware toast system
- Added visual feedback (checkmarks) on added exercises
- Added hybrid search + category filtering
- Added bottom sheet for custom exercise creation (one field only)

### 2025-01-05: Initial Implementation
- Created Exercise Picker screen specification
- Added context modes (NORMAL, ADD_TO_DAY, REPLACE)
- Added search bar with premium styling
- Added category pills
- Added exercise cards with states
- Added dark mode specifications
