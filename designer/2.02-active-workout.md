---
tags:
  - mobile
screen: Active Workout Hub
agent: "[[designer]]"
feature: "[[features/2-workout_process]]"
design_state: "[[Statuses/Finished]]"
---
# Active Workout Hub Screen

> **Parent Feature**: [2-workout_process.md](../features/2-workout_process.md)
> **Navigation**: See [00-app-overview.md](../features/00-app-overview.md) for complete flows

---

## 2. Human-Readable Summary

### Purpose
The Active Workout Hub is the central screen where users manage their workout session. It displays all exercises in their workout (queued, in progress, completed, skipped), allows adding/removing exercises, and provides options to finish or exit the workout.

### Context
**Entry Points:**
- From Exercise Picker: After adding exercises
- From Exercise Detail: After logging sets or skipping
- From Dashboard: Resume draft workout
- From Onboarding: Success Fork â†’ "I'll train on my own"

**Exit Points:**
- Back arrow: Auto-saves as draft, returns to Dashboard
- Finish Workout: Navigates to Workout Summary
- Add Exercise: Navigates to Exercise Picker

### Key Principles (Issue #5)
- **Exercises stay in user's addition order** - NEVER auto-reorder by status
- **Only ONE exercise "In Progress" at a time** - Clear visual focus
- **Non-destructive navigation** - Auto-save on exit
- **Flexible workflow** - Skip, un-skip, reorder disabled

**Interaction & Motion**
The active workout screen is designed for focus. Timer updates are smooth and non-distracting. Marking a set as complete triggers a satisfying "check" animation and a tactile vibration, giving immediate positive feedback.


---

## Screen States

1. **Empty State** - 0 exercises, encouraging message, "Add Exercise" primary button, no stats card
2. **Has Exercises (No Sets)** - 1+ exercises added, cards visible, "Finish Workout" + "Add Exercise" buttons, no stats card yet


3. **Active Workout** - 1+ sets logged, stats card appears (sets + volume), exercise cards show progress
4. **Single Exercise** - Special case, still shows both buttons, stats card appears after first set logged
5. **All Skipped** - Valid state, all exercises show "Skipped", no stats card (0 sets logged)

---

## Top Bar

**Configuration**: Back + Logo + Network Badge (follows ShapyfyTopBar component spec)

```
[â†]  Shapyfy!               [Network Badge]
```

### Specifications:
- **Height:** 56dp
- **Background:** #FFFFFF (from LightSurface)
- **Shadow:** Elevation 2dp
- **Padding:** 16dp horizontal

### Back Arrow (Left):
- Icon: `arrow_back` (Material Icon)
- Color: #000000 (from TextOnLight)
- Size: 24dp
- Position: 16dp from left edge
- Tap area: 48dp Ã— 48dp
- **Behavior:**
  - Auto-saves workout as draft
  - Navigates to Dashboard
  - Non-destructive exit (all logged data preserved)

### Logo (Center-Left):
- Text: "Shapyfy!"
- Font: 20sp / Bold (slightly smaller to fit with back button)
- Color: #000000 (from TextOnLight)
- Position: 52dp from left edge (after back button + margin)

### Network Badge (Right):
- Follows standard Top Bar component specification
- Position: 16dp from right edge
- Always visible (Offline / Online / Syncing)

---

## Content Area

- **Background:** #F3F3F8 (from LightBackground)
- **Padding:** Horizontal 16dp, Top 16dp, Bottom 80dp (space for bottom bar)
- **Scrollable:** Vertical (LazyColumn)

---

## Workout Stats Card

**Purpose:** Provides real-time workout context and progress feedback without overwhelming the user. Shows tangible workout metrics that resonate with gym culture.

**Visibility:** Only visible when `exercises.isNotEmpty()` AND at least one set has been logged.

**Position:** Top of content area, above exercise list, margin 16dp horizontal, 12dp top, 8dp bottom.

---

### Expanded State (Default)

**Container:**
- **Background:** #FFFFFF (from LightSurface)
- **Border radius:** 12dp
- **Padding:** 16dp
- **Shadow:** Elevation 2dp
- **Margin:** 16dp horizontal, 12dp top, 8dp bottom

**Layout:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ”„ 18 sets                     [â†‘]  â”‚  â† Line 1
â”‚ ðŸ‹ï¸ 3.2k kg total volume             â”‚  â† Line 2
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### Line 1: Sets Count (with icon)

**Icon:**
- Icon: `repeat` (cycle/repeat symbol from Material Icons)
- Color: `#A8E6CF` (LimeGreenDark - accent)
- Size: 18dp
- Margin right: 8dp
- Vertical alignment: Center with text

**Text:**
- Text format: "{count} sets" / "{count} set" (singular)
- Example: "18 sets" / "1 set"
- Font: 18sp / Bold
- Color: `#000000` (TextOnLight)

---

#### Line 2: Volume (with icon)

**Icon:**
- Icon: `fitness_center` (dumbbell from Material Icons) or custom weight icon if available
- Color: `#A8E6CF` (LimeGreenDark - accent)
- Size: 18dp
- Margin right: 8dp
- Vertical alignment: Center with text

**Text:**
- Text format: "{formatted_volume} kg total volume"
- Example: "3.2k kg total volume" / "845 kg total volume"
- Font: 16sp / Regular
- Color: `#666666` (TextOnLightTertiary)
- Padding top: 6dp (from Line 1)

---

#### Collapse Icon (Right)

- Icon: `expand_less` (â†‘ chevron when expanded)
- Color: `#666666` (TextOnLightTertiary)
- Size: 20dp
- Position: Top-right, padding right 16dp
- Tap area: 48dp Ã— 48dp
- Vertical alignment: Center with Line 1

---

### Collapsed State

**Container:**
- Same background, radius, shadow as expanded
- **Height:** ~48dp (single line + padding)
- Margin: 16dp horizontal, 12dp top, 8dp bottom

**Layout (NO icons in collapsed state):**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 18 sets Â· 3.2k kg             [â†“]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Combined Text (no icons):**
- Text format: "{count} sets Â· {formatted_volume} kg"
- Example: "18 sets Â· 3.2k kg" / "1 set Â· 80 kg"
- Font: 16sp / Medium
- Color: `#000000` (TextOnLight)
- Position: Left-aligned, vertically centered
- Separator: " Â· " (middle dot with spaces)

**Expand Icon (Right):**
- Icon: `expand_more` (â†“ chevron when collapsed)
- All other specs same as collapse icon

---

### Animation - Collapse/Expand

**Collapse (tap when expanded):**
- Line 2 + both icons fade out: Opacity 1 â†’ 0 (150ms)
- Container height animates: expanded height â†’ 48dp (200ms)
- Text reformats: "18 sets" â†’ "18 sets Â· 3.2k kg" (no icons)
- Collapse icon rotates: â†‘ â†’ â†“ (200ms)
- Easing: FastOutSlowIn

**Expand (tap when collapsed):**
- Container height animates: 48dp â†’ expanded height (200ms)
- Text splits: "18 sets Â· 3.2k kg" â†’ "18 sets" (Line 1) + "3.2k kg total volume" (Line 2)
- Icons fade in: Opacity 0 â†’ 1 (150ms, delay 50ms)
- Line 2 fades in: Opacity 0 â†’ 1 (150ms, delay 50ms)
- Collapse icon rotates: â†“ â†’ â†‘ (200ms)
- Easing: FastOutSlowIn

**Persist State:**
- Use local storage: `workout_stats_card_collapsed: Boolean`
- Persists across sessions
- Default: `false` (starts expanded)

---

### Calculation Logic

**Sets Count:**
```kotlin
val totalSets = workout.exercises
    .filter { it.status != ExerciseStatus.SKIPPED }
    .sumOf { it.sets.size }
```

**Total Volume:**
```kotlin
val totalVolume = workout.exercises
    .filter { it.status != ExerciseStatus.SKIPPED }
    .flatMap { it.sets }
    .sumOf { set -> set.weight * set.reps }
```

**Volume Formatting:**
```kotlin
fun formatVolume(volume: Double): String {
    return when {
        volume >= 10_000 -> "${(volume / 1000).roundToOneDecimal()}k"
        volume >= 1_000 -> "${(volume / 1000).roundToOneDecimal()}k"
        else -> volume.toInt().toString()
    }
}

// Examples:
// 845.0 â†’ "845"
// 3_247.5 â†’ "3.2k"
// 10_580.0 â†’ "10.6k"
```

---

### Update Behavior

**Real-time Updates:**
- User logs a new set â†’ Updates immediately
- User deletes a set â†’ Updates immediately
- User deletes an exercise â†’ Updates immediately
- User skips an exercise â†’ Updates immediately (removes its sets from count)
- User returns from Exercise Detail screen â†’ Updates

**Implementation:**
- Use StateFlow/Observable pattern
- Card listens to workout state changes
- No manual refresh needed

---

### Empty State Behavior

**When 0 sets logged:**
- Option A: Show "0 sets Â· 0 kg" (always visible when exercises exist)
- Option B: Hide card completely until first set logged (cleaner)

**Recommendation:** Option B (hide until first set logged)
- Cleaner initial state
- Card appears with real data when user logs first set
- Clear feedback that stats accumulate

---

### Visual Examples

**Early in workout (3 exercises, 8 sets logged):**

Expanded:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ”„ 8 sets                      [â†‘]  â”‚
â”‚ ðŸ‹ï¸ 1.2k kg total volume             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Collapsed:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8 sets Â· 1.2k kg               [â†“]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Beast mode workout (24 sets, heavy volume):**

Expanded:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ”„ 24 sets                     [â†‘]  â”‚
â”‚ ðŸ‹ï¸ 5.8k kg total volume             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Collapsed:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 24 sets Â· 5.8k kg              [â†“]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Edge Cases

**Scenario 1: User has only skipped exercises (0 sets logged)**
- Card hidden (no stats to show)
- Empty state or exercise list visible

**Scenario 2: Singular vs Plural**
- "1 set" (singular)
- "2 sets" (plural)

**Scenario 3: Very large volume (100,000+ kg)**
- Format: "125k kg" or "125.3k kg"
- Don't convert to tonnes (keep kg for consistency)

**Scenario 4: Decimal handling**
- User logs 10 reps @ 22.5 kg = 225 kg
- Sum might be 3,247.5 kg â†’ format as "3.2k kg"
- Always round to 1 decimal place for "k" format

---

## Empty State (0 Exercises)

**When:** `exercises.isEmpty()`

**Layout:** Vertical center alignment on screen

### Empty State Content (Centered)

**Icon (Optional):**
- Icon: Empty box or dumbbell illustration
- Color: #CCCCCC (light gray)
- Size: 64dp
- Margin bottom: 16dp
- Centered horizontally

**Empty State Message:**
- Text: "No exercises yet"
- Font: 18sp / Medium
- Color: #666666 (from TextOnLightTertiary)
- Text alignment: Center
- Margin bottom: 8dp

**Hint Text:**
- Text: "Tap Add Exercise to start your workout"
- Font: 14sp / Regular
- Color: #999999
- Text alignment: Center
- Margin bottom: 32dp

---

## Exercise List Ordering Rules (Issue #5)

### Primary Rule
**Exercises display in the exact order the user added them. NEVER auto-reorder by status.**

**Example Flow:**
```
User adds:
1. Squat (Queued)
2. Bench Press (Queued)
3. Deadlift (Queued)

User completes Squat:
1. Squat (Completed âœ“) â† Stays at position 1
2. Bench Press (Queued)
3. Deadlift (Queued)

User skips Bench, completes Deadlift:
1. Squat (Completed âœ“)
2. Bench Press (Skipped) â† Stays at position 2
3. Deadlift (Completed âœ“) â† Stays at position 3
```

**Visual states** (opacity, borders, checkmarks) show status. **Position never changes.**

---

## Single "In Progress" Exercise Rule (Issue #5)

**Only ONE exercise can be "In Progress" (green border) at a time.**

### State Transition Logic

**When user taps a different exercise card:**
1. Previous "In Progress" exercise auto-transitions:
   - If has logged sets â†’ Becomes "Completed" âœ“
   - If 0 sets logged â†’ Reverts to "Queued"
2. New exercise becomes "In Progress" (green border appears)
3. User navigates to Exercise Detail screen

**Purpose:** Clear visual focus, matches physical reality (doing one exercise at a time)

---

## Exercise Cards

### Exercise Card - Queued State

**Container:**
- Background: #FFFFFF (from LightSurface)
- Border radius: 12dp
- Padding: 16dp
- Margin bottom: 12dp
- **Opacity: 80%** (slightly dimmed to show not started)
- Shadow: Elevation 1dp

**Ã— Delete Icon (Top-Right Corner):**
- Position: Absolute top-right of card
- Icon: Ã—
- Color: #FF9999 (from ErrorRed)
- Size: 20dp
- Touch target: 40dp Ã— 40dp
- Padding: 10dp
- **Tap behavior:** Shows confirmation dialog (see below)

**Exercise Name:**
- Text: Exercise name (e.g., "Chest Fly")
- Font: 16sp / Medium
- Color: #000000
- Max width: Calc(full card width - 60dp) to avoid overlap with Ã— icon

**Status Text (Below name):**
- Text: "Not started"
- Font: 14sp / Regular
- Color: #666666
- Padding top: 4dp

**Bottom Padding:**
- Padding bottom: 16dp (ensures visual balance without button)

**Behavior:**
- **Entire card is tappable** â†’ navigates to Exercise Detail screen
- No nested button (card itself is the interactive element)
- Minimum height: 80dp (comfortable tap target)
- Press feedback: Scale 0.98, duration 100ms
- **Ã— icon tap** â†’ Shows confirmation, removes exercise from queue

---

### Exercise Card - In Progress State

**Container:**
- Background: #FFFFFF (from LightSurface)
- **Border: 2dp solid #A8E6CF** (highlights active exercise)
- Border radius: 12dp
- Padding: 16dp
- Margin bottom: 12dp
- **Opacity: 100%**
- Shadow: Elevation 2dp (slightly elevated)

**Ã— Delete Icon (Top-Right Corner):**
- Position: Absolute top-right of card
- Icon: Ã—
- Color: #FF9999 (from ErrorRed)
- Size: 20dp
- Touch target: 40dp Ã— 40dp
- **Tap behavior:** Shows confirmation dialog with set deletion warning

**Exercise Name:**
- Text: Exercise name (e.g., "Incline Press")
- Font: 16sp / Medium
- Color: #000000
- Max width: Calc(full card width - 60dp)

**Set Count (Below name):**
- Text format: "[X] sets logged"
- Example: "2 sets logged"
- Font: 14sp / Regular
- Color: #2D2D2D
- Padding top: 4dp

**Bottom Padding:**
- Padding bottom: 16dp (ensures visual balance without button)

**Behavior:**
- **Entire card is tappable** â†’ navigates to Exercise Detail screen
- No nested button (card itself is the interactive element)
- Green border provides clear visual affordance for active state
- Minimum height: 80dp (comfortable tap target)
- Press feedback: Scale 0.98, duration 100ms
- **Ã— icon tap** â†’ Removes exercise and deletes all logged sets (after confirmation)

---

### Exercise Card - Completed State

**Container:**
- Background: #FFFFFF (from LightSurface)
- Border radius: 12dp
- Padding: 16dp
- Margin bottom: 12dp
- **Opacity: 100%**
- Shadow: Elevation 2dp

**Ã— Delete Icon (Top-Right Corner):**
- Position: Absolute top-right of card
- Icon: Ã—
- Color: #FF9999 (from ErrorRed)
- Size: 20dp
- Touch target: 40dp Ã— 40dp
- Padding: 10dp
- **Tap behavior:** Shows confirmation dialog with set deletion warning

**Exercise Name (Left):**
- Text: Exercise name (e.g., "Bench Press")
- Font: 16sp / Medium
- Color: #000000
- Max width: Calc(full card width - 60dp)

**Checkmark Icon (Right, aligned with name):**
- Icon: Checkmark âœ“
- Color: #A8E6CF (from LimeGreenDark)
- Size: 20dp
- Position: Right of exercise name (not overlapping with Ã—)

**Set Count (Below name):**
- Text format: "[X] sets completed"
- Example: "3 sets completed"
- Font: 14sp / Regular
- Color: #666666
- Padding top: 4dp

**Bottom Padding:**
- Padding bottom: 16dp (ensures visual balance without button)

**Behavior:**
- **Entire card is tappable** â†’ navigates to Exercise Detail screen
- No nested button (card itself is the interactive element)
- Can view and still edit/add sets
- Minimum height: 80dp (comfortable tap target)
- Press feedback: Scale 0.98, duration 100ms
- **Ã— icon tap** â†’ Shows confirmation with completion + deletion warning

---

### Exercise Card - Skipped State (Issue #6)

**Context:** User skipped this exercise (0 sets logged). Exercise remains in workout with special visual state.

**Container:**
- Background: #FFFFFF (from LightSurface)
- Border radius: 12dp
- Padding: 16dp
- Margin bottom: 12dp
- **Opacity: 60%** (more dimmed than Queued 80% or Completed 100%)
- Shadow: Elevation 1dp

**Ã— Delete Icon (Top-Right Corner):**
- Position: Absolute top-right
- Icon: Ã—
- Color: #FF9999 (from ErrorRed)
- Size: 20dp
- Touch target: 40dp Ã— 40dp
- **Behavior:** Shows confirmation dialog

**Exercise Name:**
- Text: Exercise name (e.g., "Bench Press")
- Font: 16sp / Medium
- Color: #999999 (grayed out, more than Queued)
- Max width: Calc(full card width - 60dp)

**Status Text (Below name):**
- Text: "Skipped"
- Font: 14sp / Regular
- Color: #999999
- Padding top: 4dp
- Style: Italic (subtle indication of inactive state)

**Bottom Padding:**
- Padding bottom: 16dp (ensures visual balance)

**Behavior:**
- **Entire card is tappable** â†’ reopens Exercise Detail screen (un-skip functionality)
- No nested button (card itself is the interactive element)
- Exercise transitions from "Skipped" â†’ "In Progress"
- User can log sets
- Minimum height: 80dp (comfortable tap target)
- Press feedback: Scale 0.98, duration 100ms
- **Ã— icon tap** â†’ Shows confirmation, removes exercise from workout

**Purpose:** User can revisit if equipment becomes available. Non-destructive.

---

## Bottom Action Bar

**Position:** Fixed at bottom of screen
**Background:** #FFFFFF (from LightSurface)
**Shadow:** Elevation 4dp (upward)
**Padding:** 16dp all sides
**Total height:** ~120dp (includes padding)

### Button Layout
Stacked (Not Side-by-Side) - Standard mobile pattern

---

### Button Visibility Logic (Issue #2)

**Conditional Display:**
```kotlin
val showFinishButton = exercises.isNotEmpty()
```

---

### "Finish Workout" Button (Primary - Top)

**Visibility:** Only visible when `exercises.isNotEmpty()`

**Styling:**
- **Text:** "Finish Workout"
- **Background:** #A8E6CF (from LimeGreenDark - solid green)
- **Text color:** #1A1A1A (from TextOnLightCard)
- **Font:** 16sp / Bold
- **Padding:** Vertical 14dp
- **Border radius:** 12dp
- **Width:** Full width (minus 16dp padding each side)
- **Height:** 48dp
- **Shadow:** Elevation 2dp
- **Margin bottom:** 8dp (spacing to secondary button)

**Behavior:**
- Always enabled when visible (user can finish at any time after adding exercises)
- Tap â†’ **Immediately marks workout as COMPLETED** (this is the commitment point)
  - Saves workout to history
  - Clears draft state
  - Navigates to Workout Summary screen
- Shows workout stats and celebration

**State:**
- **Enabled:** Always (when visible)
- **Pressed:** Scale 0.98, duration 100ms
- **Hidden:** When `exercises.isEmpty()` - NOT disabled, completely hidden (visibility: GONE)

**Animation:**
- When first exercise added: Fade in + slide in from top (250ms spring)
- When last exercise deleted: Fade out (200ms)

**Rationale:** Clear causality - must add something before you can finish it

---

### "Add Exercise" Button (Always Visible)

**Visibility:** Always visible

**Style changes based on exercise count:**
- **When `exercises.isEmpty()`:** Primary style (solid green background, bold)
- **When `exercises.isNotEmpty()`:** Secondary style (outlined, medium weight)

---

**Primary Style (0 exercises):**
- **Text:** "Add Exercise"
- **Background:** #A8E6CF (from LimeGreenDark - solid green)
- **Text color:** #1A1A1A (from TextOnLightCard)
- **Font:** 16sp / Bold
- **Padding:** Vertical 14dp
- **Border radius:** 12dp
- **Width:** Full width
- **Height:** 48dp
- **Shadow:** Elevation 2dp

---

**Secondary Style (1+ exercises):**
- **Text:** "Add Exercise"
- **Background:** Transparent
- **Border:** 2dp solid #A8E6CF (from LimeGreenDark)
- **Text color:** #A8E6CF
- **Font:** 16sp / Medium
- **Padding:** Vertical 14dp
- **Border radius:** 12dp
- **Width:** Full width
- **Height:** 48dp

---

**Behavior:**
- Tap â†’ Navigates to Exercise Picker screen
- User can add more exercises to workout

**State:**
- **Enabled:** Always
- **Pressed:** Scale 0.98, duration 100ms

**Animation:**
- Transitions smoothly between primary/secondary styles (200ms)

**Rationale:** "Add Exercise" is always available, becomes prominent when it's the only action

---

## Remove Exercise Confirmation Dialog

**Context**: User tapped the Ã— icon on an exercise card in Active Workout screen. Confirmation dialog appears before deletion.

### Dialog Overlay
- Background dim: Semi-transparent black (#000000), 50% opacity
- Full screen overlay

### Dialog Box
- Background: #FFFFFF (from LightSurface)
- Border radius: 16dp
- Padding: 24dp
- Width: 85% of screen width
- Centered horizontally and vertically
- Shadow: Elevation 8dp

---

### Header
- Text: "Remove exercise?"
- Font size: 18sp / Bold
- Color: #000000 (from TextOnLight)
- Margin bottom: 12dp

---

### Message (Varies by Exercise State)

**If exercise is Queued (no sets logged):**
- Text: "This will remove [Exercise Name] from your workout."
- Example: "This will remove Chest Fly from your workout."

**If exercise is Skipped (no sets logged):**
- Text: "This will remove [Exercise Name] from your workout."
- Example: "This will remove Bench Press from your workout."

**If exercise is In Progress or Completed (has sets logged):**
- Text: "This will remove [Exercise Name] and delete [X] logged sets."
- Example: "This will remove Bench Press and delete 3 logged sets."

---

### Message Styling
- Font size: 14sp / Regular
- Color: #666666 (from TextOnLightTertiary)
- Line height: 20sp

---

### Warning Note
- Position: Below message
- Margin top: 8dp
- Margin bottom: 24dp
- Text: "This action cannot be undone."
- Font size: 13sp / Regular
- Color: #999999

---

### Buttons (Horizontal layout)

**Cancel Button (Left, 48% width):**
- Background: Transparent
- Border: 1dp solid #E5E5E5 (from LightGray)
- Text: "Cancel"
- Text color: #666666 (from TextOnLightTertiary)
- Font size: 14sp / Medium
- Padding vertical: 12dp
- Border radius: 8dp

**Tap Behavior:**
- Closes dialog
- No changes made

---

**Remove Button (Right, 48% width, 4% margin left):**
- Background: #FF9999 (from ErrorRed)
- Text: "Remove"
- Text color: #FFFFFF
- Font size: 14sp / Medium
- Padding vertical: 12dp
- Border radius: 8dp

**Tap Behavior:**
- Closes dialog
- Removes exercise from workout
- Deletes all associated set data
- If exercise was In Progress â†’ No automatic state change (Issue #5 - single In Progress rule doesn't auto-promote)
- If no exercises remain â†’ Show empty state

---

## Incomplete Workout Confirmation Dialog

**Context**: User tapped "Finish Workout" button while having QUEUED (untouched) exercises. This safety dialog prevents accidental data loss by confirming the user's intent.

**Trigger**: `exercises.any { it.status == ExerciseStatus.QUEUED }`

---

### Dialog Overlay
- Background dim: Semi-transparent black (#000000), 50% opacity
- Full screen overlay
- Tap outside behavior: Closes dialog (same as "Continue Workout")

### Dialog Box
- Background: #FFFFFF (from LightSurface)
- Border radius: 16dp
- Padding: 24dp
- Width: Max 320dp, min 280dp, centered
- Max height: 60% of screen height
- Shadow: Elevation 8dp

---

### Header
- Text: "Unfinished exercises" (plural) OR "Unfinished exercise" (singular)
- Font size: 20sp / Bold
- Color: #000000 (from TextOnLight)
- Margin bottom: 12dp

---

### Explanation Text
- Text (plural): "These exercises weren't started:"
- Text (singular): "This exercise wasn't started:"
- Font size: 14sp / Regular
- Color: #666666 (from TextOnLightTertiary)
- Margin bottom: 16dp

---

### Exercise List

**Container:**
- Background: Transparent
- Border: 1dp solid #E5E5E5 (top and bottom only)
- Padding: 12dp horizontal, 8dp vertical
- Max height: 40% of dialog height
- Overflow: Scrollable (LazyColumn) if > 5 exercises

**Exercise Item:**
- Bullet: "â€¢" character
- Bullet color: #666666 (TextOnLightTertiary)
- Bullet size: 14sp
- Bullet margin right: 8dp
- Exercise name font: 14sp / Medium
- Exercise name color: #000000 (TextOnLight)
- Item padding vertical: 6dp
- Long names: Truncate with ellipsis

---

### Consequence Text
- Text (plural): "They will be marked as skipped."
- Text (singular): "It will be marked as skipped."
- Font size: 14sp / Regular
- Color: #666666 (from TextOnLightTertiary)
- Margin top: 12dp
- Margin bottom: 20dp

---

### Buttons (Stacked Vertical Layout)

**Gap between buttons:** 8dp vertical

**"Continue Workout" Button (TOP - safe escape):**
- Width: 100%
- Height: 48dp
- Background: Transparent
- Border: 1.5dp solid #E5E5E5 (LightGray)
- Text: "Continue Workout"
- Text color: #666666 (from TextOnLightTertiary)
- Font size: 14sp / Medium
- Border radius: 8dp

**Tap Behavior:**
- Closes dialog
- Returns to Active Workout screen
- No changes made

---

**"Finish Anyway" Button (BOTTOM - confirm with caution):**
- Width: 100%
- Height: 48dp
- Background: #FFB366 (Orange - caution color)
- Text: "Finish Anyway"
- Text color: #1A1A1A (from TextOnLightCard)
- Font size: 14sp / Bold
- Border radius: 8dp

**Tap Behavior:**
- Closes dialog
- Marks all QUEUED exercises as SKIPPED
- Navigates to Workout Summary screen
- Workout saved to history

---

### Animations

**Dialog Entrance:**
- Overlay: Fade in, opacity 0 â†’ 50%, duration 150ms
- Dialog box: Slide up + fade in
  - TranslateY: 20dp â†’ 0dp
  - Opacity: 0 â†’ 1
  - Duration: 200ms
  - Easing: FastOutSlowIn
- Haptic: Light impact on dialog open

**Dialog Exit:**
- Dialog box: Fade out, opacity 1 â†’ 0, duration 150ms
- Overlay: Fade out, opacity 50% â†’ 0%, duration 150ms

**Button Press:**
- Scale: 0.95
- Duration: 100ms

---

### Accessibility

**Contrast Ratios (WCAG AA compliant):**
- Header (#000000) on dialog (#FFFFFF): 21:1 âœ“
- All text (#666666) on dialog (#FFFFFF): 5.74:1 âœ“
- "Finish Anyway" text (#1A1A1A) on button (#FFB366): 7.8:1 âœ“

**Touch Targets:**
- Both buttons: 100% width Ã— 48dp height (exceeds 48dp minimum)

**Screen Reader:**
- Announce: "Dialog. Unfinished exercises. [count] exercises weren't started. [list]. They will be marked as skipped."

---

### Edge Cases

**All exercises QUEUED:**
- Valid state (user added exercises but did nothing)
- Dialog shows all exercise names
- Workout saved with all exercises as SKIPPED

**Single QUEUED exercise:**
- Use singular text variants
- "Unfinished exercise", "This exercise wasn't started:", "It will be marked as skipped."

**Many exercises (5+):**
- List becomes scrollable
- Max height 40% of dialog prevents overflow

---

### Design System Note

**New Color: Orange (#FFB366)**
- Usage: Caution/warning actions that are valid but consequential
- Not for: Errors (use Red #FF9999)
- Context: Safety confirmations where user should pause and consider

---

## Developer Notes

### Delete Logic
```kotlin
fun deleteExercise(exerciseId: String) {
    // 1. Find exercise in ActiveWorkout
    val exercise = workout.exercises.find { it.id == exerciseId }

    // 2. Delete all associated sets from database
    if (exercise.setsLogged > 0) {
        setRepository.deleteSetsByExerciseId(exerciseId, workoutId)
    }

    // 3. Remove exercise from workout
    workout.exercises.removeIf { it.id == exerciseId }

    // 4. DO NOT re-index remaining exercises (preserve orderIndex)
    // Issue #5: Order is sacred, determined by user addition

    // 5. Check if workout is now empty
    if (workout.exercises.isEmpty()) {
        showEmptyWorkoutState()
    }
}
```

### State Management
```kotlin
data class ActiveWorkoutState(
    val exercises: List<WorkoutExercise> = emptyList(),
    val workoutId: String,
    val startTime: Timestamp,
    val isDraft: Boolean = true
)

// Get ordered exercise list
fun getOrderedExercises(): List<WorkoutExercise> {
    return exercises.sortedBy { it.orderIndex }
    // NEVER sort by status (Issue #5)
}
```

### Adding New Exercise
```kotlin
fun addExercise(exerciseId: String, exerciseName: String) {
    val newOrderIndex = exercises.maxOfOrNull { it.orderIndex }?.plus(1) ?: 0
    val newExercise = WorkoutExercise(
        id = UUID.randomUUID().toString(),
        exerciseId = exerciseId,
        exerciseName = exerciseName,
        status = ExerciseStatus.QUEUED,
        sets = emptyList(),
        orderIndex = newOrderIndex  // Always append to end
    )
    exercises.add(newExercise)
}
```

---

## Edge Cases

### Scenario 1: User Deletes In Progress Exercise
**Behavior:**
- Exercise removed
- Sets deleted
- No other exercise auto-promoted to In Progress
- User must manually tap another exercise to start it
- Rationale: Respects user intent, no automatic decisions

### Scenario 2: User Deletes All Exercises Mid-Workout
**Behavior:**
- Empty state appears
- "Finish Workout" button disappears
- "Add Exercise" button becomes primary (solid green)
- Workout remains as draft (can add more exercises)
- Back arrow still saves as draft

### Scenario 3: User Taps Completed Exercise Card
**Behavior:**
- Exercise becomes In Progress (previous In Progress auto-transitions)
- Navigates to Exercise Detail
- User can add more sets or edit existing sets
- Rationale: Flexibility for users who want to add more volume

### Scenario 4: User Has 10 Exercises, All Skipped
**Behavior:**
- All 10 cards show with "Skipped" state (60% opacity, italic)
- "Finish Workout" button visible (user can finish workout with 0 sets)
- Workout Summary will show all as skipped
- Valid use case: User scouted gym, found all equipment occupied

---

## Revision History

### 2025-01-05: Workout Stats Card Addition
- Added collapsible Workout Stats Card (sets count + total volume)
- Icon integration: repeat icon for sets, dumbbell for volume
- Real-time updates from workout state
- Gym culture focus: volume tracking as primary metric
- Collapsed/expanded states with smooth animations
- Persists user preference across sessions

### 2025-01-05: Critical UX Fixes
- Added empty state (0 exercises) with encouraging message
- Fixed "Finish Workout" button visibility (Issue #2)
- Implemented exercise ordering rules (Issue #5 - no auto-reorder)
- Added Single "In Progress" rule with state transitions
- Added Skipped exercise state (Issue #6)
- Updated remove exercise confirmation dialog

### 2025-01-11: UX Review & Redesign
- Added back arrow for non-destructive exit (auto-saves draft)
- Moved "Finish Workout" to bottom bar (stacked buttons)
- Made entire card tappable (not just buttons)
- Added network badge to top bar

### 2025-11-06: Exercise Card Refinement (Button Removal)
- **Removed nested buttons from all exercise cards** ("Start", "Continue")
- Cards are now pure interactive elements (entire card is clickable)
- Added consistent 16dp bottom padding to all card states
- Emphasized opacity hierarchy (80% queued, 100% active/completed, 60% skipped)
- Cleaner, more modern mobile UI pattern
- Improved tap target (entire card vs small button)
- Rationale: Buttons created visual redundancy and clutter

### 2025-11-18: Incomplete Workout Confirmation Dialog
- **Added**: Safety dialog when finishing workout with QUEUED (untouched) exercises
- Prevents accidental data loss by showing which exercises weren't started
- Marks QUEUED exercises as SKIPPED on confirmation
- Stacked vertical buttons for gym-friendly tap targets
- **New color**: Orange (#FFB366) for caution actions
- Button priority: "Continue Workout" (safe escape) + "Finish Anyway" (orange, confirm)
- Full accessibility compliance (WCAG AA)

### 2025-01-05: Documentation Restructure
- Extracted from workout_process.md into dedicated file
- Following onboarding convention (screen-centric organization)
- All related dialogs (remove exercise) now live in this file
